    cdef void find_neighbors(self):

        cdef int i
        cdef int j
        cdef int k
        cdef mc_siteObj neighbor_site
        cdef mc_siteObj home_site
        cdef mc_neighborObj neighbor_Obj

        for i in range(self.i_length):
            for j in range(self.j_length):
                for k in range(self.k_length):

                    home_site = <mc_siteObj>self.supercell[i,j,k]

                    neighbor_site = <mc_siteObj>self.supercell[i,j,self.apply_bc(k,1,self.k_length)]
                    site_index = neighbor_site.get_index()
                    site_pos = neighbor_site.get_pos()
                    neighbor_obj = <mc_neighborObj>mc_neighborObj(site_index,site_pos,1,'OUT')
                    home_site.add_neighbor(neighbor_obj)

                    neighbor_site = <mc_siteObj>self.supercell[i,j,self.apply_bc(k,-1,self.k_length)]
                    site_index = neighbor_site.get_index()
                    site_pos = neighbor_site.get_pos()
                    neighbor_obj = <mc_neighborObj>mc_neighborObj(site_index,site_pos,1,'OUT')
                    home_site.add_neighbor(neighbor_obj)

                    neighbor_site = <mc_siteObj>self.supercell[self.apply_bc(i,-1,self.i_length),j,self.apply_bc(k,1,self.k_length)]
                    site_index = neighbor_site.get_index()
                    site_pos = neighbor_site.get_pos()
                    neighbor_obj = <mc_neighborObj>mc_neighborObj(site_index,site_pos,1,'OUT')
                    home_site.add_neighbor(neighbor_obj)

                    neighbor_site = <mc_siteObj>self.supercell[self.apply_bc(i,-1,self.i_length),j,self.apply_bc(k,-1,self.k_length)]
                    site_index = neighbor_site.get_index()
                    site_pos = neighbor_site.get_pos()
                    neighbor_obj = <mc_neighborObj>mc_neighborObj(site_index,site_pos,1,'OUT')
                    home_site.add_neighbor(neighbor_obj)

                    neighbor_site = <mc_siteObj>self.supercell[i,self.apply_bc(j,-1,self.j_length),self.apply_bc(k,1,self.k_length)]
                    site_index = neighbor_site.get_index()
                    site_pos = neighbor_site.get_pos()
                    neighbor_obj = <mc_neighborObj>mc_neighborObj(site_index,site_pos,1,'OUT')
                    home_site.add_neighbor(neighbor_obj)

                    neighbor_site = <mc_siteObj>self.supercell[i,self.apply_bc(j,-1,self.j_length),self.apply_bc(k,-1,self.k_length)]
                    site_index = neighbor_site.get_index()
                    site_pos = neighbor_site.get_pos()
                    neighbor_obj = <mc_neighborObj>mc_neighborObj(site_index,site_pos,1,'OUT')
                    home_site.add_neighbor(neighbor_obj)

                    neighbor_site = <mc_siteObj>self.supercell[self.apply_bc(i,-1,self.i_length),self.apply_bc(j,-1,self.j_length),self.apply_bc(k,1,self.k_length)]
                    site_index = neighbor_site.get_index()
                    site_pos = neighbor_site.get_pos()
                    neighbor_obj = <mc_neighborObj>mc_neighborObj(site_index,site_pos,1,'OUT')
                    home_site.add_neighbor(neighbor_obj)

                    neighbor_site = <mc_siteObj>self.supercell[self.apply_bc(i,-1,self.i_length),self.apply_bc(j,-1,self.j_length),self.apply_bc(k,-1,self.k_length)]
                    site_index = neighbor_site.get_index()
                    site_pos = neighbor_site.get_pos()
                    neighbor_obj = <mc_neighborObj>mc_neighborObj(site_index,site_pos,1,'OUT')
                    home_site.add_neighbor(neighbor_obj)


                    neighbor_site = <mc_siteObj>self.supercell[self.apply_bc(i,1,self.i_length),j,k]
                    site_index = neighbor_site.get_index()
                    site_pos = neighbor_site.get_pos()
                    neighbor_obj = <mc_neighborObj>mc_neighborObj(site_index,site_pos,2,'IN')
                    home_site.add_neighbor(neighbor_obj)

                    neighbor_site = <mc_siteObj>self.supercell[self.apply_bc(i,-1,self.i_length),j,k]
                    site_index = neighbor_site.get_index()
                    site_pos = neighbor_site.get_pos()
                    neighbor_obj = <mc_neighborObj>mc_neighborObj(site_index,site_pos,2,'IN')
                    home_site.add_neighbor(neighbor_obj)

                    neighbor_site = <mc_siteObj>self.supercell[i,self.apply_bc(j,1,self.j_length),k]
                    site_index = neighbor_site.get_index()
                    site_pos = neighbor_site.get_pos()
                    neighbor_obj = <mc_neighborObj>mc_neighborObj(site_index,site_pos,2,'IN')
                    home_site.add_neighbor(neighbor_obj)

                    neighbor_site = <mc_siteObj>self.supercell[i,self.apply_bc(j,-1,self.j_length),k]
                    site_index = neighbor_site.get_index()
                    site_pos = neighbor_site.get_pos()
                    neighbor_obj = <mc_neighborObj>mc_neighborObj(site_index,site_pos,2,'IN')
                    home_site.add_neighbor(neighbor_obj)

                    neighbor_site = <mc_siteObj>self.supercell[i,j,self.apply_bc(k,2,self.k_length)]
                    site_index = neighbor_site.get_index()
                    site_pos = neighbor_site.get_pos()
                    neighbor_obj = <mc_neighborObj>mc_neighborObj(site_index,site_pos,2,'OUT')
                    home_site.add_neighbor(neighbor_obj)

                    neighbor_site = <mc_siteObj>self.supercell[i,j,self.apply_bc(k,-2,self.k_length)]
                    site_index = neighbor_site.get_index()
                    site_pos = neighbor_site.get_pos()
                    neighbor_obj = <mc_neighborObj>mc_neighborObj(site_index,site_pos,2,'OUT')
                    home_site.add_neighbor(neighbor_obj)


                    neighbor_site = <mc_siteObj>self.supercell[self.apply_bc(i,1,self.i_length),j,self.apply_bc(k,2,self.k_length)]
                    site_index = neighbor_site.get_index()
                    site_pos = neighbor_site.get_pos()
                    neighbor_obj = <mc_neighborObj>mc_neighborObj(site_index,site_pos,3,'OUT')
                    home_site.add_neighbor(neighbor_obj)

                    neighbor_site = <mc_siteObj>self.supercell[self.apply_bc(i,1,self.i_length),j,self.apply_bc(k,-2,self.k_length)]
                    site_index = neighbor_site.get_index()
                    site_pos = neighbor_site.get_pos()
                    neighbor_obj = <mc_neighborObj>mc_neighborObj(site_index,site_pos,3,'OUT')
                    home_site.add_neighbor(neighbor_obj)

                    neighbor_site = <mc_siteObj>self.supercell[self.apply_bc(i,-1,self.i_length),j,self.apply_bc(k,2,self.k_length)]
                    site_index = neighbor_site.get_index()
                    site_pos = neighbor_site.get_pos()
                    neighbor_obj = <mc_neighborObj>mc_neighborObj(site_index,site_pos,3,'OUT')
                    home_site.add_neighbor(neighbor_obj)

                    neighbor_site = <mc_siteObj>self.supercell[self.apply_bc(i,-1,self.i_length),j,self.apply_bc(k,-2,self.k_length)]
                    site_index = neighbor_site.get_index()
                    site_pos = neighbor_site.get_pos()
                    neighbor_obj = <mc_neighborObj>mc_neighborObj(site_index,site_pos,3,'OUT')
                    home_site.add_neighbor(neighbor_obj)

                    neighbor_site = <mc_siteObj>self.supercell[i,self.apply_bc(j,1,self.j_length),self.apply_bc(k,2,self.k_length)]
                    site_index = neighbor_site.get_index()
                    site_pos = neighbor_site.get_pos()
                    neighbor_obj = <mc_neighborObj>mc_neighborObj(site_index,site_pos,3,'OUT')
                    home_site.add_neighbor(neighbor_obj)

                    neighbor_site = <mc_siteObj>self.supercell[i,self.apply_bc(j,1,self.j_length),self.apply_bc(k,-2,self.k_length)]
                    site_index = neighbor_site.get_index()
                    site_pos = neighbor_site.get_pos()
                    neighbor_obj = <mc_neighborObj>mc_neighborObj(site_index,site_pos,3,'OUT')
                    home_site.add_neighbor(neighbor_obj)

                    neighbor_site = <mc_siteObj>self.supercell[i,self.apply_bc(j,-1,self.j_length),self.apply_bc(k,2,self.k_length)]
                    site_index = neighbor_site.get_index()
                    site_pos = neighbor_site.get_pos()
                    neighbor_obj = <mc_neighborObj>mc_neighborObj(site_index,site_pos,3,'OUT')
                    home_site.add_neighbor(neighbor_obj)

                    neighbor_site = <mc_siteObj>self.supercell[i,self.apply_bc(j,-1,self.j_length),self.apply_bc(k,-2,self.k_length)]
                    site_index = neighbor_site.get_index()
                    site_pos = neighbor_site.get_pos()
                    neighbor_obj = <mc_neighborObj>mc_neighborObj(site_index,site_pos,3,'OUT')
                    home_site.add_neighbor(neighbor_obj)

                    neighbor_site = <mc_siteObj>self.supercell[self.apply_bc(i,1,self.i_length),self.apply_bc(j,1,self.j_length),k]
                    site_index = neighbor_site.get_index()
                    site_pos = neighbor_site.get_pos()
                    neighbor_obj = <mc_neighborObj>mc_neighborObj(site_index,site_pos,3,'IN')
                    home_site.add_neighbor(neighbor_obj)

                    neighbor_site = <mc_siteObj>self.supercell[self.apply_bc(i,1,self.i_length),self.apply_bc(j,-1,self.j_length),k]
                    site_index = neighbor_site.get_index()
                    site_pos = neighbor_site.get_pos()
                    neighbor_obj = <mc_neighborObj>mc_neighborObj(site_index,site_pos,3,'IN')
                    home_site.add_neighbor(neighbor_obj)

                    neighbor_site = <mc_siteObj>self.supercell[self.apply_bc(i,-1,self.i_length),self.apply_bc(j,1,self.j_length),k]
                    site_index = neighbor_site.get_index()
                    site_pos = neighbor_site.get_pos()
                    neighbor_obj = <mc_neighborObj>mc_neighborObj(site_index,site_pos,3,'IN')
                    home_site.add_neighbor(neighbor_obj)

                    neighbor_site = <mc_siteObj>self.supercell[self.apply_bc(i,-1,self.i_length),self.apply_bc(j,-1,self.j_length),k]
                    site_index = neighbor_site.get_index()
                    site_pos = neighbor_site.get_pos()
                    neighbor_obj = <mc_neighborObj>mc_neighborObj(site_index,site_pos,3,'IN')
                    home_site.add_neighbor(neighbor_obj)
